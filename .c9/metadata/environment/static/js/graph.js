{"filter":false,"title":"graph.js","tooltip":"/static/js/graph.js","undoManager":{"mark":100,"position":100,"stack":[[{"start":{"row":352,"column":10},"end":{"row":352,"column":15},"action":"remove","lines":["chart"],"id":1482},{"start":{"row":352,"column":10},"end":{"row":352,"column":11},"action":"insert","lines":["d"]},{"start":{"row":352,"column":11},"end":{"row":352,"column":12},"action":"insert","lines":["a"]},{"start":{"row":352,"column":12},"end":{"row":352,"column":13},"action":"insert","lines":["t"]}],[{"start":{"row":352,"column":10},"end":{"row":352,"column":13},"action":"remove","lines":["dat"],"id":1483},{"start":{"row":352,"column":10},"end":{"row":352,"column":19},"action":"insert","lines":["dataTable"]}],[{"start":{"row":345,"column":8},"end":{"row":353,"column":7},"action":"remove","lines":["  var ofs = 0, pag = 17;","      function update_offset() {","          var totFilteredRecs = ndx.groupAll().value();","          var end = ofs + pag > totFilteredRecs ? totFilteredRecs : ofs + pag;","          ofs = ofs >= totFilteredRecs ? Math.floor((totFilteredRecs - 1) / pag) * pag : ofs;","          ofs = ofs < 0 ? 0 : ofs;","          dataTable.beginSlice(ofs);","          dataTable.endSlice(ofs+pag);","      }"],"id":1484}],[{"start":{"row":345,"column":5},"end":{"row":375,"column":7},"action":"remove","lines":["   ","      function display() {","          var totFilteredRecs = ndx.groupAll().value();","          var end = ofs + pag > totFilteredRecs ? totFilteredRecs : ofs + pag;","          d3.select('#begin')","              .text(end === 0? ofs : ofs + 1);","          d3.select('#end')","              .text(end);","          d3.select('#last')","              .attr('disabled', ofs-pag<0 ? 'true' : null);","          d3.select('#next')","              .attr('disabled', ofs+pag>=totFilteredRecs ? 'true' : null);","          d3.select('#size').text(totFilteredRecs);","          if(totFilteredRecs != ndx.size()){","            d3.select('#totalsize').text(\"(filtered Total: \" + ndx.size() + \" )\");","          }else{","            d3.select('#totalsize').text('');","          }","      }","      function next() {","          ofs += pag;","          update_offset();","          chart.redraw();","      }","      function last() {","          ofs -= pag;","          update_offset();","          chart.redraw();","      }","","       "],"id":1485}],[{"start":{"row":345,"column":5},"end":{"row":346,"column":7},"action":"remove","lines":["","       "],"id":1486},{"start":{"row":345,"column":5},"end":{"row":346,"column":7},"action":"remove","lines":["","       "]},{"start":{"row":345,"column":5},"end":{"row":346,"column":7},"action":"remove","lines":["","       "]},{"start":{"row":345,"column":5},"end":{"row":346,"column":7},"action":"remove","lines":["","       "]},{"start":{"row":345,"column":5},"end":{"row":346,"column":7},"action":"remove","lines":["","       "]},{"start":{"row":345,"column":5},"end":{"row":346,"column":7},"action":"remove","lines":["","       "]},{"start":{"row":345,"column":5},"end":{"row":346,"column":7},"action":"remove","lines":["","       "]},{"start":{"row":345,"column":5},"end":{"row":346,"column":7},"action":"remove","lines":["","       "]},{"start":{"row":345,"column":5},"end":{"row":346,"column":7},"action":"remove","lines":["","       "]},{"start":{"row":345,"column":5},"end":{"row":346,"column":7},"action":"remove","lines":["","       "]},{"start":{"row":345,"column":5},"end":{"row":346,"column":7},"action":"remove","lines":["","       "]},{"start":{"row":345,"column":5},"end":{"row":346,"column":7},"action":"remove","lines":["","       "]}],[{"start":{"row":345,"column":5},"end":{"row":346,"column":7},"action":"remove","lines":["","       "],"id":1487},{"start":{"row":345,"column":5},"end":{"row":346,"column":7},"action":"remove","lines":["","       "]},{"start":{"row":345,"column":5},"end":{"row":346,"column":7},"action":"remove","lines":["","       "]},{"start":{"row":345,"column":5},"end":{"row":346,"column":7},"action":"remove","lines":["","       "]},{"start":{"row":345,"column":5},"end":{"row":346,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":384,"column":3},"end":{"row":384,"column":17},"action":"remove","lines":["     -------*/"],"id":1488}],[{"start":{"row":345,"column":46},"end":{"row":345,"column":60},"action":"insert","lines":["     -------*/"],"id":1489}],[{"start":{"row":345,"column":50},"end":{"row":345,"column":51},"action":"remove","lines":[" "],"id":1490},{"start":{"row":345,"column":49},"end":{"row":345,"column":50},"action":"remove","lines":[" "]},{"start":{"row":345,"column":48},"end":{"row":345,"column":49},"action":"remove","lines":[" "]},{"start":{"row":345,"column":47},"end":{"row":345,"column":48},"action":"remove","lines":[" "]},{"start":{"row":345,"column":46},"end":{"row":345,"column":47},"action":"remove","lines":[" "]}],[{"start":{"row":254,"column":14},"end":{"row":254,"column":15},"action":"remove","lines":["5"],"id":1491}],[{"start":{"row":254,"column":14},"end":{"row":254,"column":15},"action":"insert","lines":["0"],"id":1492}],[{"start":{"row":254,"column":14},"end":{"row":254,"column":15},"action":"remove","lines":["0"],"id":1493}],[{"start":{"row":254,"column":14},"end":{"row":254,"column":15},"action":"insert","lines":["1"],"id":1494}],[{"start":{"row":254,"column":14},"end":{"row":254,"column":15},"action":"remove","lines":["1"],"id":1495}],[{"start":{"row":254,"column":14},"end":{"row":254,"column":15},"action":"insert","lines":["0"],"id":1496}],[{"start":{"row":256,"column":52},"end":{"row":256,"column":53},"action":"remove","lines":["1"],"id":1497}],[{"start":{"row":256,"column":52},"end":{"row":256,"column":53},"action":"insert","lines":["0"],"id":1498}],[{"start":{"row":256,"column":52},"end":{"row":256,"column":53},"action":"remove","lines":["0"],"id":1499}],[{"start":{"row":256,"column":52},"end":{"row":256,"column":53},"action":"insert","lines":["1"],"id":1500}],[{"start":{"row":256,"column":31},"end":{"row":256,"column":32},"action":"remove","lines":["1"],"id":1501}],[{"start":{"row":256,"column":31},"end":{"row":256,"column":32},"action":"insert","lines":["2"],"id":1502}],[{"start":{"row":256,"column":31},"end":{"row":256,"column":32},"action":"remove","lines":["2"],"id":1503}],[{"start":{"row":256,"column":31},"end":{"row":256,"column":32},"action":"insert","lines":["1"],"id":1504},{"start":{"row":256,"column":32},"end":{"row":256,"column":33},"action":"insert","lines":["0"]},{"start":{"row":256,"column":33},"end":{"row":256,"column":34},"action":"insert","lines":["0"]}],[{"start":{"row":256,"column":34},"end":{"row":256,"column":35},"action":"remove","lines":["0"],"id":1505}],[{"start":{"row":256,"column":33},"end":{"row":256,"column":34},"action":"remove","lines":["0"],"id":1506},{"start":{"row":256,"column":32},"end":{"row":256,"column":33},"action":"remove","lines":["0"]},{"start":{"row":256,"column":31},"end":{"row":256,"column":32},"action":"remove","lines":["1"]}],[{"start":{"row":256,"column":31},"end":{"row":256,"column":32},"action":"insert","lines":["2"],"id":1507},{"start":{"row":256,"column":32},"end":{"row":256,"column":33},"action":"insert","lines":["0"]}],[{"start":{"row":260,"column":21},"end":{"row":260,"column":22},"action":"remove","lines":["5"],"id":1508}],[{"start":{"row":260,"column":21},"end":{"row":260,"column":22},"action":"insert","lines":["8"],"id":1509}],[{"start":{"row":260,"column":21},"end":{"row":260,"column":22},"action":"remove","lines":["8"],"id":1510}],[{"start":{"row":260,"column":21},"end":{"row":260,"column":22},"action":"insert","lines":["5"],"id":1511}],[{"start":{"row":366,"column":27},"end":{"row":366,"column":28},"action":"remove","lines":["s"],"id":1512}],[{"start":{"row":366,"column":27},"end":{"row":366,"column":28},"action":"insert","lines":["S"],"id":1513}],[{"start":{"row":351,"column":36},"end":{"row":352,"column":12},"action":"remove","lines":["","            "],"id":1514},{"start":{"row":351,"column":36},"end":{"row":352,"column":13},"action":"remove","lines":["","             "]}],[{"start":{"row":362,"column":35},"end":{"row":363,"column":0},"action":"remove","lines":["",""],"id":1515}],[{"start":{"row":365,"column":28},"end":{"row":366,"column":11},"action":"remove","lines":["","           "],"id":1516}],[{"start":{"row":373,"column":0},"end":{"row":374,"column":0},"action":"remove","lines":["",""],"id":1517}],[{"start":{"row":372,"column":9},"end":{"row":373,"column":0},"action":"insert","lines":["",""],"id":1518},{"start":{"row":373,"column":0},"end":{"row":373,"column":8},"action":"insert","lines":["        "]}],[{"start":{"row":373,"column":8},"end":{"row":374,"column":0},"action":"insert","lines":["",""],"id":1519},{"start":{"row":374,"column":0},"end":{"row":374,"column":8},"action":"insert","lines":["        "]}],[{"start":{"row":374,"column":8},"end":{"row":375,"column":0},"action":"remove","lines":["",""],"id":1520}],[{"start":{"row":374,"column":4},"end":{"row":374,"column":8},"action":"remove","lines":["    "],"id":1521},{"start":{"row":374,"column":0},"end":{"row":374,"column":4},"action":"remove","lines":["    "]},{"start":{"row":373,"column":8},"end":{"row":374,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":373,"column":17},"end":{"row":373,"column":18},"action":"remove","lines":[" "],"id":1522},{"start":{"row":373,"column":16},"end":{"row":373,"column":17},"action":"remove","lines":[" "]},{"start":{"row":373,"column":12},"end":{"row":373,"column":16},"action":"remove","lines":["    "]},{"start":{"row":373,"column":8},"end":{"row":373,"column":12},"action":"remove","lines":["    "]}],[{"start":{"row":372,"column":9},"end":{"row":373,"column":0},"action":"insert","lines":["",""],"id":1523},{"start":{"row":373,"column":0},"end":{"row":373,"column":8},"action":"insert","lines":["        "]}],[{"start":{"row":361,"column":0},"end":{"row":362,"column":0},"action":"remove","lines":["",""],"id":1524}],[{"start":{"row":361,"column":9},"end":{"row":361,"column":10},"action":"remove","lines":[" "],"id":1525},{"start":{"row":361,"column":8},"end":{"row":361,"column":9},"action":"remove","lines":[" "]}],[{"start":{"row":361,"column":8},"end":{"row":362,"column":0},"action":"insert","lines":["",""],"id":1526},{"start":{"row":362,"column":0},"end":{"row":362,"column":8},"action":"insert","lines":["        "]}],[{"start":{"row":357,"column":0},"end":{"row":358,"column":0},"action":"remove","lines":["",""],"id":1527}],[{"start":{"row":356,"column":0},"end":{"row":357,"column":0},"action":"remove","lines":["",""],"id":1528}],[{"start":{"row":354,"column":0},"end":{"row":355,"column":0},"action":"remove","lines":["",""],"id":1529}],[{"start":{"row":351,"column":9},"end":{"row":351,"column":10},"action":"remove","lines":[" "],"id":1530},{"start":{"row":351,"column":8},"end":{"row":351,"column":9},"action":"remove","lines":[" "]}],[{"start":{"row":347,"column":9},"end":{"row":347,"column":10},"action":"remove","lines":[" "],"id":1531}],[{"start":{"row":348,"column":9},"end":{"row":348,"column":10},"action":"remove","lines":[" "],"id":1532}],[{"start":{"row":349,"column":9},"end":{"row":349,"column":10},"action":"remove","lines":[" "],"id":1533}],[{"start":{"row":349,"column":8},"end":{"row":349,"column":9},"action":"remove","lines":[" "],"id":1534}],[{"start":{"row":348,"column":8},"end":{"row":348,"column":9},"action":"remove","lines":[" "],"id":1535}],[{"start":{"row":347,"column":8},"end":{"row":347,"column":9},"action":"remove","lines":[" "],"id":1536}],[{"start":{"row":330,"column":5},"end":{"row":331,"column":0},"action":"remove","lines":["",""],"id":1537}],[{"start":{"row":330,"column":4},"end":{"row":330,"column":5},"action":"remove","lines":[" "],"id":1538},{"start":{"row":330,"column":0},"end":{"row":330,"column":4},"action":"remove","lines":["    "]}],[{"start":{"row":0,"column":0},"end":{"row":376,"column":3},"action":"remove","lines":["queue()","    .defer(d3.json, 'static/data/characters.json')","    .await(makeGraphs);","    ","function makeGraphs(error, charactersData) {","    var ndx = crossfilter(charactersData);","    ","   ","    ","    charactersData.forEach(function(d){","        ","        d.appearances = parseInt(d.appearances);","        d.first_appearance=parseInt(d.first-appearance);","      ","    });","   ","","    show_alignment(ndx);","    show_identity(ndx);","    gender_selector(ndx);","    show_gender_percent(ndx, 'male characters', '#male-percent');","    show_gender_percent(ndx, 'female characters', '#female-percent');","    show_gender_percent(ndx, 'genderless characters', '#others-percent');","    show_numberOfAppearance(ndx);","    show_eyeColor(ndx);","    show_hairColor(ndx);","    show_alive(ndx);","    show_listCharacters(ndx);","   ","    updateResult();","   ","    ","    dc.renderAll();","","}","","/*----------Helper Functions-----------*/","","","//To remove empty values from grouped data//","","function remove_blanks(group, value_to_remove) {","    ","    return {","        all: function() {","            return group.all().filter(function(d) {","                return d.key !== value_to_remove;","            });","        }","    };","}","","/*------------Gender count and Percentage ---------*/","","function gender_selector(ndx) {","    var genderDim = ndx.dimension(dc.pluck('sex'));","    var genderGroup = remove_blanks(genderDim.group(), \"\");","","    dc.selectMenu('#genderPercent')","        .dimension(genderDim)","        .group(genderGroup);","}","","function show_gender_percent(ndx, sex, element) {","    var genderPercent = ndx.groupAll().reduce(","        // Sum totals for each gender type","        function(p, v) {","            p.total++;","            if (v.sex === sex) {","                p.sex_count++;","            }","            return p;","        },","        function(p, v) {","            p.total--;","            if (v.sex === sex) {","                p.sex_count--;","            }","            return p;","        },","        function() {","            return { total: 0, sex_count: 0 };","        }","    );","","    dc.numberDisplay(element)","        .formatNumber(d3.format('.2%'))","        .valueAccessor(function(d) {","            if (d.sex_count == 0) {","                return 0;","            }","            else {","                return (d.sex_count / d.total);","            }","        })","        .group(genderPercent);","}",""," /*-----------------Pie Chart Identity -----------------------*/","","function show_identity(ndx) {","    var dim = ndx.dimension(dc.pluck(\"id\"));","    var group = remove_blanks(dim.group(), \"\");","    ","     var pieColors = d3.scale.ordinal()","      .range(['#e9ab18', '#4682B4','#ADDFAD']);","","    dc.pieChart(\"#identity\")","      .height(250)","      .width(400)","      .radius(115)","      .transitionDuration(1000)","      .colors(pieColors)","      .dimension(dim)","      .group(group)","      .legend(dc.legend().x(310).y(10).itemHeight(10).gap(10));","  }  ","","","","","/*--------------Align Barchart---------*/","","function show_alignment(ndx) {","    ","      //Counting each align group","","    function alignmentByGender(dimension, align) {","        return dimension.group().reduce(","            function (p, v) {","                p.total++;","                if (v.align === align) {","                    p.match++;","                };","                return p;","            },","            function (p, v) {","                p.total--;","                if (v.align === align) {","                    p.match--;","                };","                return p;","            },","            function () {","                return { total: 0, match: 0 }","            }","            ","        );","        ","    };","     // stacked barchart to show number of characters who are good / bad / neutral","    ","    var alignmentColors = d3.scale.ordinal()","        .range(['#e9ab18', '#4682B4','#0E9E8D']);   //,'#ADDFAD'","   ","","    var dim = ndx.dimension(dc.pluck(\"sex\"));","  //  var genderGroup = remove_blanks(dim.group(), \"\");","    var goodByGender = alignmentByGender(dim, \"good characters\"); ","    var badByGender = alignmentByGender(dim, \"bad characters\");","    var neutralByGender = alignmentByGender(dim, \"neutral characters\");","  ","    dc.barChart(\"#bar-alignment\")","        ","        .height(350)","        .width(600)","        //.useViewBoxResizing(true) //to make the chart responsive","        .centerBar(true)","        .dimension(dim)","        .group(goodByGender, \"Good\")","        .stack(badByGender, \"Bad\")","        .stack(neutralByGender, \"Neutral\")","        .valueAccessor(function (d) {","            if(d.value.total > 0) {","                return (d.value.match / d.value.total) * 100","            } else {","                return 0;","            }","            return d.value.percent * 100;","            ","        })","       ","        .colors(alignmentColors)","        .x(d3.scale.ordinal())","        .xUnits(dc.units.ordinal)","        .barPadding(0.2)","        .xAxisLabel(\"Gender\")","        .legend(dc.legend().x(490).y(10).itemHeight(15).gap(10))","        .margins({top: 10, right: 100, bottom: 60, left: 120});","      // .renderlet(function(chart) {","     //   chart.selectAll(\"g.x text\").attr('dx', '-30').attr(","     // 'dy', '-7').attr('transform', \"rotate(-60)\"); });"," ","        ","}","","","/*--------------------scatterplot--------------*/","","function show_numberOfAppearance(ndx) {","     ","      var genderColors = d3.scale.ordinal()","        .domain([\"female\", \"male\"])","        .range([\"pink\", \"blue\"]);","        ","      var yearDim = ndx.dimension(function (d) {","      return d.year;","      ","       });  ","        ","      var xyearDim = ndx.dimension(function(d){","        return [d.year, d.appearances, d.sex];","       });","       ","       var yearAppearanceGroup = xyearDim.group();","    ","       var minYear = yearDim.bottom(1)[0].year;","       var maxYear = yearDim.top(1)[0].year;","    ","    dc.scatterPlot(\"#appearance\")","        .width(750)","        .height(400)","        .x(d3.scale.linear().domain([minYear,maxYear]))","        .brushOn(false)","        .symbolSize(8)","        .clipPadding(10)","        .elasticX(true)","        .xAxisLabel(\"Year\")","        .elasticY(true)","        .yAxisLabel(\"Apperarance\")","        .title(function (d) {","            return d.key[1] + \" appearances \";","        })","        ","        .colorAccessor(function (d) {","            return d.key[2];","        })","        .colors(genderColors)","        .dimension(yearDim)","        .group(yearAppearanceGroup)","        .margins({top: 10, right: 50, bottom: 75, left: 55});","       ","}","  /*------------------Alive Bar chart-----------*/","  ","   function show_alive(ndx) {","    var dim = ndx.dimension(dc.pluck(\"alive\"));","    var group = remove_blanks(dim.group(), \"\");","    ","     var aliveColors = d3.scale.ordinal()","        .range(['#4682B4']);","   ","   ","    dc.barChart(\"#bar-alive\")","      .width(300)","      .height(400)","      .margins({top: 10,right: 20,bottom: 30,left: 110})","      .colors(aliveColors)","      .dimension(dim)","      .group(group)","      .barPadding(0.05)","      .transitionDuration(1000)","      .x(d3.scale.ordinal())","      .xUnits(dc.units.ordinal)","      .elasticY(false)","      .xAxisLabel(\"Alive\")","      .yAxis()","      .ticks(10);","   }","    ","   ","","","/*------------------Eye Color Pie Chart-----------*/",""," function show_eyeColor(ndx) {","     ","     var pieColors = d3.scale.ordinal()","        .range(['#4682B4','#8C6746','black', '#B1AA4E',\t'#FF4500','#ADDFAD','#e9ab18', '#F2BC79', '#B2762D', '#DCAB6E']);","   ","    var dim = ndx.dimension(dc.pluck(\"eye\"));","    var group = remove_blanks(dim.group(), \"\");","    ","    dc.pieChart(\"#eye-color\")","      .height(300)","      .width(500)","      .innerRadius(50)","      .radius(125)","      .transitionDuration(1000)","      .colors(pieColors)","      .dimension(dim)","      .group(group)","      .legend(dc.legend().x(400).y(10).itemHeight(12).gap(5));","      ","  }  ","  ","  /*------------------Hair Color Pie Chart-----------*/",""," function show_hairColor(ndx) {","     ","     var pieColors = d3.scale.ordinal()","        .range(['black','#8C6746','#e9ab18', '#FF4500','#ADDFAD', '#5A87A0','#F2BC79', '#8C6746', '#B1AA4E', '#B2762D', '#DCAB6E']);","   ","    var dim = ndx.dimension(dc.pluck(\"hair\"));","    var group = remove_blanks(dim.group(), \"\");","    ","    dc.pieChart(\"#hair-color\")","      .height(300)","      .width(500)","      .innerRadius(50)","      .radius(125)","      .transitionDuration(1000)","      .colors(pieColors)","      .dimension(dim)","      .group(group)","      .legend(dc.legend().x(400).y(10).itemHeight(12).gap(5));","      ","  }  ","","  ","   /*------------------List of characters-----------*/","    ","   "," function show_listCharacters(ndx) {  ","   var dataTable = dc.dataTable(\"#all-characters\");","  ","   var dim = ndx.dimension(dc.pluck(\"name\"));"," // console.log(dim.top(Infinity));","  ","     dataTable","      .dimension(dim)","      .group(function(d) {","        return \"\";","      })","      .columns([\"name\", \"urlslug\", \"first appearance\"])","      .size(Infinity)","      .sortBy(dc.pluck(\"name\")) // This line of code is corrected by stackoverflow","","      .order(d3.ascending)","      .transitionDuration(1000);","     ","      ","       }","       ","       /*-----------------Table Pagination-----------*/","  ","        var resultStart = 0; var resultEnd =21;","        var ndx;","        var dataTable = dc.dataTable;","          ","        function displayResult() {","            document.getElementById(\"start\").innerHTML = resultStart;","            document.getElementById(\"end\").innerHTML = resultStart + resultEnd-1;","            document.getElementById(\"totalSize\").innerHTML = ndx.size();","            d3.select('#prev').attr('disabled', resultStart-resultEnd < 0 ? 'true' : null);","            d3.select('#next').attr('disabled', resultStart+resultEnd >= ndx.size() ? 'true' : null);","        }","        ","        function updateResult() {","            dataTable.beginSlice(resultStart);","            dataTable.endSlice(resultStart + resultEnd);","            displayResult();","        }","","        function prev() {","          resultStart -= resultEnd;","          updateResult();","          dataTable.redraw();","        }","        ","        function next() {","            resultStart += resultEnd;","            updateResult();","            dataTable.redraw();","        }","        ","   "],"id":1539},{"start":{"row":0,"column":0},"end":{"row":337,"column":1},"action":"insert","lines":["queue()","  .defer(d3.json, 'static/data/characters.json')","  .await(makeGraphs);","  ","function makeGraphs(error, charactersData) {","  var ndx = crossfilter(charactersData);","​","  charactersData.forEach(function(d) {","    d.appearances = parseInt(d.appearances);","    d.first_appearance=parseInt(d.first-appearance);","   ","  });","  ","  show_alignment(ndx);","  show_identity(ndx);","  gender_selector(ndx);","  show_gender_percent(ndx, 'male characters', '#male-percent');","  show_gender_percent(ndx, 'female characters', '#female-percent');","  show_gender_percent(ndx, 'genderless characters', '#others-percent');","  show_numberOfAppearance(ndx);","  show_eyeColor(ndx);","  show_hairColor(ndx);","  show_alive(ndx);","  show_listCharacters(ndx);","​","  dc.renderAll();","}","​","/*----------Helper Functions-----------*/","​","​","//To remove empty values from grouped data//","​","function remove_blanks(group, value_to_remove) {","  return {","    all: function() {","      return group.all().filter(function(d) {","        return d.key !== value_to_remove;","      });","    }","  };","}","​","/*------------Gender count and Percentage ---------*/","​","function gender_selector(ndx) {","  var genderDim = ndx.dimension(dc.pluck('sex'));","  var genderGroup = remove_blanks(genderDim.group(), \"\");","​","  dc.selectMenu('#genderPercent')","    .dimension(genderDim)","    .group(genderGroup);","}","​","function show_gender_percent(ndx, sex, element) {","  var genderPercent = ndx.groupAll().reduce(","    // Sum totals for each gender type","    function(p, v) {","      p.total++;","      if (v.sex === sex) {","        p.sex_count++;","      }","      return p;","    },","    function(p, v) {","      p.total--;","      if (v.sex === sex) {","        p.sex_count--;","      }","      return p;","    },","    function() {","      return { total: 0, sex_count: 0 };","    }","  );","​","  dc.numberDisplay(element)","    .formatNumber(d3.format('.2%'))","    .valueAccessor(function(d) {","      if (d.sex_count == 0) {","        return 0;","      }","      else {","        return (d.sex_count / d.total);","      }","    })","    .group(genderPercent);","}","​"," /*-----------------Pie Chart Identity -----------------------*/","​","function show_identity(ndx) {","  var dim = ndx.dimension(dc.pluck(\"id\"));","  var group = remove_blanks(dim.group(), \"\");","  ","   var pieColors = d3.scale.ordinal()","   .range(['#e9ab18', '#4682B4','#ADDFAD']);","​","  dc.pieChart(\"#identity\")","   .height(250)","   .width(400)","   .radius(115)","   .transitionDuration(1000)","   .colors(pieColors)","   .dimension(dim)","   .group(group)","   .legend(dc.legend().x(310).y(10).itemHeight(10).gap(10));","}","​","/*--------------Align Barchart---------*/","function show_alignment(ndx) {","  //Counting each align group","  function alignmentByGender(dimension, align) {","    return dimension.group().reduce(","      function (p, v) {","        p.total++;","        if (v.align === align) {","          p.match++;","        };","        return p;","      },","      function (p, v) {","        p.total--;","        if (v.align === align) {","          p.match--;","        };","        return p;","      },","      function () {","        return { total: 0, match: 0 }","      }","    );","  };","   // stacked barchart to show number of characters who are good / bad / neutral","  ","  var alignmentColors = d3.scale.ordinal()","    .range(['#e9ab18', '#4682B4','#0E9E8D']);  //,'#ADDFAD'","​","  var dim = ndx.dimension(dc.pluck(\"sex\"));","  dim.filterFunction(function(d) {","    console.log(d + ' -> ' + (d !== ''));","    return d !== '';","  });","  var goodByGender = alignmentByGender(dim, \"good characters\"); ","  var badByGender = alignmentByGender(dim, \"bad characters\");","  var neutralByGender = alignmentByGender(dim, \"neutral characters\");"," ","  dc.barChart(\"#bar-alignment\")","    .height(350)","    .width(600)","    // .useViewBoxResizing(true) //to make the chart responsive","    .centerBar(true)","    .dimension(dim)","    .group(goodByGender, \"Good\")","    .stack(badByGender, \"Bad\")","    .stack(neutralByGender, \"Neutral\")","    .valueAccessor(function (d) {","      if(d.value.total > 0) {","        return (d.value.match / d.value.total) * 100","      } else {","        return 0;","      }","      return d.value.percent * 100;","    })","    .colors(alignmentColors)","    .x(d3.scale.ordinal())","    .xUnits(dc.units.ordinal)","    .barPadding(0.2)","    .xAxisLabel(\"Gender\")","    .legend(dc.legend().x(490).y(10).itemHeight(15).gap(10))","    .margins({top: 10, right: 100, bottom: 60, left: 120});","   // .renderlet(function(chart) {","   //  chart.selectAll(\"g.x text\").attr('dx', '-30').attr(","   // 'dy', '-7').attr('transform', \"rotate(-60)\"); });","}","​","​","/*--------------------scatterplot--------------*/","​","function show_numberOfAppearance(ndx) {","  var genderColors = d3.scale.ordinal()","    .domain([\"female\", \"male\"])","    .range([\"pink\", \"blue\"]);","  ","  var yearDim = ndx.dimension(function (d) {","    return d.year;","  }); ","    ","  var xyearDim = ndx.dimension(function(d){","    return [d.year, d.appearances, d.sex];","  });","  ","  var yearAppearanceGroup = xyearDim.group();","  var minYear = yearDim.bottom(1)[0].year;","  var maxYear = yearDim.top(1)[0].year;","​","  dc.scatterPlot(\"#appearance\")","    .width(750)","    .height(400)","    .x(d3.scale.linear().domain([minYear,maxYear]))","    .brushOn(false)","    .symbolSize(8)","    .clipPadding(10)","    .elasticX(true)","    .xAxisLabel(\"Year\")","    .elasticY(true)","    .yAxisLabel(\"Apperarance\")","    .title(function (d) {","      return d.key[1] + \" appearances \";","    })","    .colorAccessor(function (d) {","      return d.key[2];","    })","    .colors(genderColors)","    .dimension(yearDim)","    .group(yearAppearanceGroup)","    .margins({top: 10, right: 50, bottom: 75, left: 55});","}"," /*------------------Alive Bar chart-----------*/"," ","function show_alive(ndx) {","  var dim = ndx.dimension(dc.pluck(\"alive\"));","  var group = remove_blanks(dim.group(), \"\");","  ","  var aliveColors = d3.scale.ordinal()","    .range(['#4682B4']);","​","  dc.barChart(\"#bar-alive\")","    .width(300)","    .height(400)","    .margins({top: 10,right: 20,bottom: 30,left: 110})","    .colors(aliveColors)","    .dimension(dim)","    .group(group)","    .barPadding(0.05)","    .transitionDuration(1000)","    .x(d3.scale.ordinal())","    .xUnits(dc.units.ordinal)","    .elasticY(false)","    .xAxisLabel(\"Alive\")","    .yAxis()","    .ticks(10);","}","​","/*------------------Eye Color Pie Chart-----------*/","function show_eyeColor(ndx) {","  var pieColors = d3.scale.ordinal()","    .range(['#4682B4','#8C6746','black', '#B1AA4E',\t'#FF4500','#ADDFAD','#e9ab18', '#F2BC79', '#B2762D', '#DCAB6E']);","  ","  var dim = ndx.dimension(dc.pluck(\"eye\"));","  var group = remove_blanks(dim.group(), \"\");","  ","  dc.pieChart(\"#eye-color\")","   .height(300)","   .width(500)","   .innerRadius(50)","   .radius(125)","   .transitionDuration(1000)","   .colors(pieColors)","   .dimension(dim)","   .group(group)","   .legend(dc.legend().x(400).y(10).itemHeight(12).gap(5));","}"," "," /*------------------Hair Color Pie Chart-----------*/","​"," function show_hairColor(ndx) {","   ","   var pieColors = d3.scale.ordinal()","    .range(['black','#8C6746','#e9ab18', '#FF4500','#ADDFAD', '#5A87A0','#F2BC79', '#8C6746', '#B1AA4E', '#B2762D', '#DCAB6E']);","  ","  var dim = ndx.dimension(dc.pluck(\"hair\"));","  var group = remove_blanks(dim.group(), \"\");","  ","  dc.pieChart(\"#hair-color\")","   .height(300)","   .width(500)","   .innerRadius(50)","   .radius(125)","   .transitionDuration(1000)","   .colors(pieColors)","   .dimension(dim)","   .group(group)","   .legend(dc.legend().x(400).y(10).itemHeight(12).gap(5));","   "," } ","​"," ","  /*------------------List of characters-----------*/","  ","  "," function show_listCharacters(ndx) {","  var dataTable = dc.dataTable(\"#all-characters\");","  var dim = ndx.dimension(dc.pluck(\"name\"));","  var resultStart = 0;","  var resultEnd = 21;","​","  function updateResult() {","    function displayResult() {","      document.getElementById(\"start\").innerHTML = resultStart;","      document.getElementById(\"end\").innerHTML = resultStart + resultEnd-1;","      document.getElementById(\"totalSize\").innerHTML = ndx.size();","      d3.select('#prev').attr('disabled', resultStart-resultEnd < 0 ? 'true' : null);","      d3.select('#next').attr('disabled', resultStart+resultEnd >= ndx.size() ? 'true' : null);","    }","  ","    dataTable.beginSlice(resultStart);","    dataTable.endSlice(resultStart + resultEnd);","    displayResult();","  }","​"," // console.log(dim.top(Infinity));","  dataTable","    .dimension(dim)","    .group(function(d) {","      return \"\";","    })","    .columns([\"name\", \"urlslug\", \"first appearance\"])","    .size(Infinity)","    .sortBy(dc.pluck(\"name\")) // This line of code is corrected by stackoverflow","​","    .order(d3.ascending)","    .transitionDuration(1000);","​","  updateResult();","​","  $('#prev').click(function() {","    resultStart -= resultEnd;","    updateResult();","    dataTable.redraw();","  });","​","  $('#next').click(function() {","    resultStart += resultEnd;","    updateResult();","    dataTable.redraw();","  });","}"]}],[{"start":{"row":323,"column":0},"end":{"row":323,"column":1},"action":"remove","lines":["​"],"id":1540}],[{"start":{"row":320,"column":0},"end":{"row":320,"column":1},"action":"remove","lines":["​"],"id":1541}],[{"start":{"row":325,"column":0},"end":{"row":325,"column":1},"action":"remove","lines":["​"],"id":1542}],[{"start":{"row":331,"column":0},"end":{"row":331,"column":1},"action":"remove","lines":["​"],"id":1543}],[{"start":{"row":310,"column":0},"end":{"row":310,"column":1},"action":"remove","lines":["​"],"id":1544}],[{"start":{"row":296,"column":0},"end":{"row":296,"column":1},"action":"remove","lines":["​"],"id":1545}],[{"start":{"row":286,"column":0},"end":{"row":286,"column":1},"action":"remove","lines":["​"],"id":1546}],[{"start":{"row":265,"column":0},"end":{"row":265,"column":1},"action":"remove","lines":["​"],"id":1547}],[{"start":{"row":243,"column":0},"end":{"row":243,"column":1},"action":"remove","lines":["​"],"id":1548}],[{"start":{"row":226,"column":0},"end":{"row":226,"column":1},"action":"remove","lines":["​"],"id":1549}],[{"start":{"row":195,"column":0},"end":{"row":195,"column":1},"action":"remove","lines":["​"],"id":1550}],[{"start":{"row":175,"column":0},"end":{"row":175,"column":1},"action":"remove","lines":["​"],"id":1551}],[{"start":{"row":176,"column":0},"end":{"row":176,"column":1},"action":"remove","lines":["​"],"id":1552}],[{"start":{"row":178,"column":0},"end":{"row":178,"column":1},"action":"remove","lines":["​"],"id":1553}],[{"start":{"row":137,"column":0},"end":{"row":137,"column":1},"action":"remove","lines":["​"],"id":1554}],[{"start":{"row":108,"column":0},"end":{"row":108,"column":1},"action":"remove","lines":["​"],"id":1555}],[{"start":{"row":97,"column":0},"end":{"row":97,"column":1},"action":"remove","lines":["​"],"id":1556}],[{"start":{"row":90,"column":0},"end":{"row":90,"column":1},"action":"remove","lines":["​"],"id":1557}],[{"start":{"row":88,"column":0},"end":{"row":88,"column":1},"action":"remove","lines":["​"],"id":1558}],[{"start":{"row":75,"column":0},"end":{"row":75,"column":1},"action":"remove","lines":["​"],"id":1559}],[{"start":{"row":53,"column":0},"end":{"row":53,"column":1},"action":"remove","lines":["​"],"id":1560}],[{"start":{"row":48,"column":0},"end":{"row":48,"column":1},"action":"remove","lines":["​"],"id":1561}],[{"start":{"row":44,"column":0},"end":{"row":44,"column":1},"action":"remove","lines":["​"],"id":1562}],[{"start":{"row":42,"column":0},"end":{"row":42,"column":1},"action":"remove","lines":["​"],"id":1563}],[{"start":{"row":32,"column":0},"end":{"row":32,"column":1},"action":"remove","lines":["​"],"id":1564}],[{"start":{"row":30,"column":0},"end":{"row":30,"column":1},"action":"remove","lines":["​"],"id":1565}],[{"start":{"row":29,"column":0},"end":{"row":29,"column":1},"action":"remove","lines":["​"],"id":1566}],[{"start":{"row":27,"column":0},"end":{"row":27,"column":1},"action":"remove","lines":["​"],"id":1567}],[{"start":{"row":24,"column":0},"end":{"row":24,"column":1},"action":"remove","lines":["​"],"id":1568}],[{"start":{"row":6,"column":0},"end":{"row":6,"column":1},"action":"remove","lines":["​"],"id":1569}],[{"start":{"row":139,"column":2},"end":{"row":142,"column":5},"action":"remove","lines":["dim.filterFunction(function(d) {","    console.log(d + ' -> ' + (d !== ''));","    return d !== '';","  });"],"id":1570}],[{"start":{"row":139,"column":1},"end":{"row":139,"column":2},"action":"remove","lines":[" "],"id":1571},{"start":{"row":139,"column":0},"end":{"row":139,"column":1},"action":"remove","lines":[" "]},{"start":{"row":138,"column":43},"end":{"row":139,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":284,"column":22},"end":{"row":284,"column":23},"action":"insert","lines":["T"],"id":1572}],[{"start":{"row":284,"column":22},"end":{"row":284,"column":23},"action":"remove","lines":["T"],"id":1573}],[{"start":{"row":284,"column":40},"end":{"row":284,"column":41},"action":"insert","lines":[" "],"id":1574},{"start":{"row":284,"column":41},"end":{"row":284,"column":42},"action":"insert","lines":["T"]}],[{"start":{"row":284,"column":42},"end":{"row":284,"column":43},"action":"insert","lines":["a"],"id":1575},{"start":{"row":284,"column":43},"end":{"row":284,"column":44},"action":"insert","lines":["b"]},{"start":{"row":284,"column":44},"end":{"row":284,"column":45},"action":"insert","lines":["l"]},{"start":{"row":284,"column":45},"end":{"row":284,"column":46},"action":"insert","lines":["e"]}],[{"start":{"row":322,"column":13},"end":{"row":322,"column":14},"action":"insert","lines":["o"],"id":1576},{"start":{"row":322,"column":14},"end":{"row":322,"column":15},"action":"insert","lines":["n"]}],[{"start":{"row":322,"column":15},"end":{"row":322,"column":16},"action":"remove","lines":["c"],"id":1577}],[{"start":{"row":322,"column":15},"end":{"row":322,"column":16},"action":"insert","lines":["C"],"id":1578}],[{"start":{"row":322,"column":15},"end":{"row":322,"column":16},"action":"remove","lines":["C"],"id":1579},{"start":{"row":322,"column":14},"end":{"row":322,"column":15},"action":"remove","lines":["n"]},{"start":{"row":322,"column":13},"end":{"row":322,"column":14},"action":"remove","lines":["o"]}],[{"start":{"row":322,"column":13},"end":{"row":322,"column":14},"action":"insert","lines":["c"],"id":1580}],[{"start":{"row":291,"column":19},"end":{"row":291,"column":20},"action":"remove","lines":["1"],"id":1581},{"start":{"row":291,"column":18},"end":{"row":291,"column":19},"action":"remove","lines":["2"]}],[{"start":{"row":291,"column":18},"end":{"row":291,"column":19},"action":"insert","lines":["1"],"id":1582},{"start":{"row":291,"column":19},"end":{"row":291,"column":20},"action":"insert","lines":["0"]},{"start":{"row":291,"column":20},"end":{"row":291,"column":21},"action":"insert","lines":["1"]}]]},"ace":{"folds":[],"scrolltop":4038.359375,"scrollleft":0,"selection":{"start":{"row":291,"column":21},"end":{"row":291,"column":21},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":242,"state":"no_regex","mode":"ace/mode/javascript"}},"timestamp":1562363928354,"hash":"7c61747377c2b0092e5c8f4173d9b10f608a8030"}